<mxfile host="app.diagrams.net" modified="2021-12-09T07:38:27.012Z" agent="5.0 (Windows)" etag="Thr1jMadHeqS5c9eQ73D" version="15.9.4" type="github">
  <diagram id="kvoGo0gfQWNKkFxHk639" name="Page-1">
    <mxGraphModel dx="1578" dy="784" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="JKBhCjqjnzoE227UuKIU-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="wVERp9EFQYTSEjUQM9i8-1" target="JKBhCjqjnzoE227UuKIU-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wVERp9EFQYTSEjUQM9i8-1" value="start" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;fontColor=#FFFFFF;labelBackgroundColor=#000000;fillColor=#000000;fontStyle=1;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="408.5" y="164" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-1" value="&lt;h1&gt;Calling Bytecode Functions Flochart&lt;br&gt;&lt;/h1&gt;&lt;p&gt;This flowchart shows how created bytecode functions will be executed in Micropython. So at first we it get memory base on state size of function to be executed. if the size code is small enough so we use stack for it otherwise use heap memory. after getting memory initial code state structure by calling mp_setup_code_stat() function. and finally code state structure to mp_executed_code() in order to run it on vertual machine. &lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="30" y="10" width="810" height="120" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-4" target="JKBhCjqjnzoE227UuKIU-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-4" value="Use Heap for allocation" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontSize=14;fillColor=#dae8fc;fontStyle=1;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="520" y="358" width="190" height="35" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-7" target="JKBhCjqjnzoE227UuKIU-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-7" target="JKBhCjqjnzoE227UuKIU-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-7" value="state_size ?" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;rounded=1;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#ffff88;fontStyle=1;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="377.5" y="283" width="112.5" height="70" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Helvetica;fontSize=12;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-10" target="JKBhCjqjnzoE227UuKIU-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-10" value="Decode Code State Size" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontSize=14;fontColor=#333333;fillColor=#f5f5f5;fontStyle=1;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="338.5" y="219" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-13" target="JKBhCjqjnzoE227UuKIU-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-13" value="Use Stack for acllocation" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontSize=14;fillColor=#d5e8d4;fontStyle=1;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="147.5" y="358" width="190" height="35" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-18" value="&lt;font style=&quot;font-size: 12px&quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;stack_size &amp;gt;=&lt;/font&gt; &lt;/font&gt;VM_MAX_STATE_ON_STACK" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;fontFamily=Helvetica;fontSize=10;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="577" y="290.5" width="75" height="45" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-17" value="&lt;font style=&quot;font-size: 12px&quot;&gt;stack_size &amp;lt; &lt;/font&gt;VM_MAX_STATE_ON_STACK" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;fontFamily=Helvetica;fontSize=10;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="205" y="290.5" width="75" height="45" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-28" target="JKBhCjqjnzoE227UuKIU-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-28" value="Initial Code State by calling mp_setup_code_state() function" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#ffe6cc;fontStyle=1;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="285" y="448" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-33" target="JKBhCjqjnzoE227UuKIU-35">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="424" y="573" />
              <mxPoint x="424" y="573" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-33" value="Execute Code by callling mp_execute_bytecode() function" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#fff2cc;fontStyle=1;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="280" y="533" width="292.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.335;entryY=-0.011;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-35" target="JKBhCjqjnzoE227UuKIU-44">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="250" y="657" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-35" target="JKBhCjqjnzoE227UuKIU-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="595" y="657" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-35" value="&lt;font style=&quot;font-size: 14px&quot;&gt;Check Return Value&lt;/font&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;rounded=1;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#ffff88;fontStyle=1;verticalAlign=middle;spacing=0;flipH=1;flipV=1;direction=south;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="328.75" y="613" width="191.25" height="88.75" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-44" target="JKBhCjqjnzoE227UuKIU-53">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-44" value="Result&amp;nbsp; = *sp" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#cce5ff;fontStyle=1;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="205" y="701.13" width="135" height="51.25" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=14;fontColor=#000000;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-45" target="JKBhCjqjnzoE227UuKIU-53">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-45" value="Result = code_state-&amp;gt;state[0]" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#e1d5e7;fontStyle=1;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="490" y="701.75" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-47" value="MP_VM_RETURN_NORMAL" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;fontFamily=Helvetica;fontSize=10;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="202" y="634.88" width="75" height="45" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-50" value="MP_VM_RETURN_Exception" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=#FFFFFF;fontFamily=Helvetica;fontSize=10;fontColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="575.5" y="634.88" width="75" height="45" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Helvetica;fontSize=14;fontColor=#FFFFFF;" edge="1" parent="1" source="JKBhCjqjnzoE227UuKIU-53" target="JKBhCjqjnzoE227UuKIU-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-53" value="Free Heap Memory" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=14;fillColor=#cdeb8b;fontStyle=1;strokeColor=#36393d;labelBorderColor=none;" vertex="1" parent="1">
          <mxGeometry x="321.25" y="813" width="210" height="50" as="geometry" />
        </mxCell>
        <mxCell id="JKBhCjqjnzoE227UuKIU-58" value="End" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;rounded=1;labelBackgroundColor=#000000;fontFamily=Helvetica;fontSize=14;fontColor=#FFFFFF;fillColor=#000000;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="401.38" y="903" width="50" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
